version: "3"

includes:
  utils:
    taskfile: ./Util.yml
    internal: true
    dir: ../

tasks:
  up:
    desc: Run the game server on docker container
    preconditions:
      - test -f compose.yml
    cmds:
      - docker compose up --build

  up-detach:
    desc: Run the game server on docker container in detach mode
    preconditions:
      - test -f compose.yml
    cmds:
      - docker compose up --build -d

  down:
    desc: Shutdown the game server docker container
    preconditions:
      - test -f compose.yml
    cmds:
      - docker compose down

  local:
    desc: Run the game server locally
    deps: [utils:check-base-env, utils:check-lambda-env]
    cmds:
      - go mod download
      - go run ./cmd/server
